<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition"
        xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <AutoRefresh>0</AutoRefresh>

  <DataSources>
    <DataSource Name="IAReportDataSet">
      <ConnectionProperties>
        <DataProvider>System.Data.DataSet</DataProvider>
        <ConnectString>/* Local Connection */</ConnectString>
      </ConnectionProperties>
      <rd:DataSourceID>ee78fdaa-396f-42e3-91d9-f483562fe7f3</rd:DataSourceID>
    </DataSource>
  </DataSources>

  <DataSets>
    <DataSet Name="IADataSource">
      <Query>
        <DataSourceName>IAReportDataSet</DataSourceName>
        <CommandText>/* Local Query */</CommandText>
      </Query>
      <Fields>
        <Field Name="Register_Number">
          <DataField>Register_Number</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Name">
          <DataField>Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Sem">
          <DataField>Sem</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Course_Code">
          <DataField>Course_Code</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Course_Name">
          <DataField>Course_Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Assessment_ID">
          <DataField>Assessment_ID</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="Assessment_Name">
          <DataField>Assessment_Name</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="Max_Marks">
          <DataField>Max_Marks</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="Marks">
          <DataField>Marks</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="IsTotal">
          <DataField>IsTotal</DataField>
          <rd:TypeName>System.Boolean</rd:TypeName>
        </Field>
        <Field Name="TotalMarks">
          <DataField>TotalMarks</DataField>
          <rd:TypeName>System.Decimal</rd:TypeName>
        </Field>
        <Field Name="CourseOrder">
          <DataField>CourseOrder</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>IAReportDataSet</rd:DataSetName>
        <rd:TableName>IAData</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>

  <Body>
    <ReportItems>
      <Tablix Name="matrixStudentWide">
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>3.0cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>6.0cm</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.5cm</Width>
            </TablixColumn>
            <!-- dynamic column template (repeated for each Course_Assessment) -->
            <TablixColumn>
              <Width>2.5cm</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <!-- Header row -->
            <TablixRow>
              <Height>0.7cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="hdrReg">
                      <CanGrow>true</CanGrow>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Register Number</Value>
                              <Style>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <BackgroundColor>LightSteelBlue</BackgroundColor>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>3pt</PaddingLeft>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="hdrName">
                      <CanGrow>true</CanGrow>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Name</Value>
                              <Style>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <BackgroundColor>LightSteelBlue</BackgroundColor>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>3pt</PaddingLeft>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="hdrSem">
                      <CanGrow>true</CanGrow>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>Sem</Value>
                              <Style>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <BackgroundColor>LightSteelBlue</BackgroundColor>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>3pt</PaddingLeft>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                        <TextAlign>Center</TextAlign>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <!-- dynamic header for each Course_Assessment column -->
                <TablixCell>
                  <CellContents>
                    <Textbox Name="hdrDynamic">
                      <CanGrow>true</CanGrow>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Course_Code.Value &amp; "/" &amp; Fields!Assessment_Name.Value</Value>
                              <Style>
                                <FontWeight>Bold</FontWeight>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <BackgroundColor>LightSteelBlue</BackgroundColor>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <TextAlign>Center</TextAlign>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
            <!-- Data row (one per student) -->
            <TablixRow>
              <Height>0.6cm</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="valReg">
                      <CanGrow>true</CanGrow>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Register_Number.Value</Value>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>3pt</PaddingLeft>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="valName">
                      <CanGrow>true</CanGrow>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Name.Value</Value>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <PaddingLeft>3pt</PaddingLeft>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="valSem">
                      <CanGrow>true</CanGrow>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!Sem.Value</Value>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <TextAlign>Center</TextAlign>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <!-- dynamic data cell -->
                <TablixCell>
                  <CellContents>
                    <Textbox Name="valDynamic">
                      <CanGrow>true</CanGrow>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Max(IIF(Fields!IsTotal.Value, Fields!TotalMarks.Value, Fields!Marks.Value))</Value>
                            </TextRun>
                          </TextRuns>
                          <Style />
                        </Paragraph>
                      </Paragraphs>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <TextAlign>Center</TextAlign>
                        <Color>=IIF(First(Fields!IsTotal.Value), IIF(First(Fields!TotalMarks.Value) &lt; 20, "Red", "Black"), "Black")</Color>
                        <FontWeight>=IIF(First(Fields!IsTotal.Value) AND First(Fields!TotalMarks.Value) &lt; 20, "Bold", "Normal")</FontWeight>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>

        <!-- Column groups: 3 static + 1 dynamic -->
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember />
            <TablixMember />
            <TablixMember>
              <Group Name="cgCols">
                <GroupExpressions>
                  <GroupExpression>=Fields!Course_Code.Value &amp; "_" &amp; Fields!Assessment_Name.Value</GroupExpression>
                </GroupExpressions>
                <SortExpressions>
                  <SortExpression>
                    <Value>=Fields!CourseOrder.Value</Value>
                  </SortExpression>
                  <SortExpression>
                    <Value>=IIF(Fields!Assessment_Name.Value="Total", 9999, Fields!Assessment_ID.Value)</Value>
                  </SortExpression>
                </SortExpressions>
              </Group>
              <TablixHeader>
                <Size>0.7cm</Size>
                <CellContents>
                  <Textbox Name="hdrDynamic2">
                    <CanGrow>true</CanGrow>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>=Fields!Course_Code.Value &amp; "/" &amp; Fields!Assessment_Name.Value</Value>
                            <Style>
                              <FontWeight>Bold</FontWeight>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style />
                      </Paragraph>
                    </Paragraphs>
                    <Style>
                      <BackgroundColor>LightSteelBlue</BackgroundColor>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <TextAlign>Center</TextAlign>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
            </TablixMember>
          </TablixMembers>
        </TablixColumnHierarchy>

        <!-- Row groups: header (static) + student group -->
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember />
            <TablixMember>
              <Group Name="rgStudent">
                <GroupExpressions>
                  <GroupExpression>=Fields!Register_Number.Value</GroupExpression>
                </GroupExpressions>
                <SortExpressions>
                  <SortExpression>
                    <Value>=Fields!Register_Number.Value</Value>
                  </SortExpression>
                </SortExpressions>
              </Group>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>

        <DataSetName>IADataSource</DataSetName>
        <Top>0.5cm</Top>
        <Left>0.5cm</Left>
        <Height>1.3cm</Height>
        <Width>20cm</Width>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
    <Height>5in</Height>
    <Style />
  </Body>

  <Width>21cm</Width>
  <Page>
    <PageHeight>29.7cm</PageHeight>
    <PageWidth>21cm</PageWidth>
    <LeftMargin>1cm</LeftMargin>
    <RightMargin>1cm</RightMargin>
    <TopMargin>1cm</TopMargin>
    <BottomMargin>1cm</BottomMargin>
    <Style />
  </Page>

  <rd:ReportUnitType>Cm</rd:ReportUnitType>
  <rd:ReportID>ab2f0b0c-2c2e-42d0-99af-1a1dc6b7b777</rd:ReportID>
</Report>
