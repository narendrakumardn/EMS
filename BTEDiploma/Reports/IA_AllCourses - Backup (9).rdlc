<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition"
        xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
	<AutoRefresh>0</AutoRefresh>

	<DataSources>
		<DataSource Name="IAReportDataSet">
			<ConnectionProperties>
				<DataProvider>System.Data.DataSet</DataProvider>
				<ConnectString>/* Local Connection */</ConnectString>
			</ConnectionProperties>
			<rd:DataSourceID>ee78fdaa-396f-42e3-91d9-f483562fe7f3</rd:DataSourceID>
		</DataSource>
	</DataSources>

	<DataSets>
		<DataSet Name="IADataSource">
			<Query>
				<DataSourceName>IAReportDataSet</DataSourceName>
				<CommandText>/* Local Query */</CommandText>
			</Query>
			<Fields>
				<Field Name="Register_Number">
					<DataField>Register_Number</DataField>
					<rd:TypeName>System.String</rd:TypeName>
				</Field>
				<Field Name="Name">
					<DataField>Name</DataField>
					<rd:TypeName>System.String</rd:TypeName>
				</Field>
				<Field Name="Sem">
					<DataField>Sem</DataField>
					<rd:TypeName>System.Int32</rd:TypeName>
				</Field>
				<Field Name="Course_Code">
					<DataField>Course_Code</DataField>
					<rd:TypeName>System.String</rd:TypeName>
				</Field>
				<Field Name="Course_Name">
					<DataField>Course_Name</DataField>
					<rd:TypeName>System.String</rd:TypeName>
				</Field>
				<Field Name="Assessment_ID">
					<DataField>Assessment_ID</DataField>
					<rd:TypeName>System.Int32</rd:TypeName>
				</Field>
				<Field Name="Assessment_Name">
					<DataField>Assessment_Name</DataField>
					<rd:TypeName>System.String</rd:TypeName>
				</Field>
				<Field Name="Max_Marks">
					<DataField>Max_Marks</DataField>
					<rd:TypeName>System.Decimal</rd:TypeName>
				</Field>
				<Field Name="Marks">
					<DataField>Marks</DataField>
					<rd:TypeName>System.Decimal</rd:TypeName>
				</Field>
				<Field Name="IsTotal">
					<DataField>IsTotal</DataField>
					<rd:TypeName>System.Boolean</rd:TypeName>
				</Field>
				<Field Name="TotalMarks">
					<DataField>TotalMarks</DataField>
					<rd:TypeName>System.Decimal</rd:TypeName>
				</Field>
				<Field Name="CourseOrder">
					<DataField>CourseOrder</DataField>
					<rd:TypeName>System.Int32</rd:TypeName>
				</Field>
				<Field Name="CoursePageGroup">
					<DataField>CoursePageGroup</DataField>
					<rd:TypeName>System.Int32</rd:TypeName>
				</Field>
			</Fields>
			<rd:DataSetInfo>
				<rd:DataSetName>IAReportDataSet</rd:DataSetName>
				<rd:TableName>IAData</rd:TableName>
			</rd:DataSetInfo>
		</DataSet>
	</DataSets>

	<ReportSections>
		<ReportSection>
			<Body>
				<ReportItems>
					<!-- Page Group List (Groups courses into sets of 2 per page) -->
					<List Name="lstPageGroups">
						<DataSetName>IADataSource</DataSetName>
						<Grouping>
							<GroupExpressions>
								<GroupExpression>=Ceiling(Fields!CourseOrder.Value / 2.0)</GroupExpression>
							</GroupExpressions>
						</Grouping>
						<SortExpressions>
							<SortExpression>
								<Value>=Ceiling(Fields!CourseOrder.Value / 2.0)</Value>
							</SortExpression>
						</SortExpressions>
						<ReportItems>
							<!-- Header for each page group -->
							<Textbox Name="txtPageHeader">
								<CanGrow>true</CanGrow>
								<Paragraphs>
									<Paragraph>
										<TextRuns>
											<TextRun>
												<Value>="Internal Assessment Report - Page " &amp; Ceiling(First(Fields!CourseOrder.Value) / 2.0)</Value>
												<Style>
													<FontSize>14pt</FontSize>
													<FontWeight>Bold</FontWeight>
													<TextAlign>Center</TextAlign>
												</Style>
											</TextRun>
										</TextRuns>
										<Style>
											<TextAlign>Center</TextAlign>
										</Style>
									</Paragraph>
								</Paragraphs>
								<Style>
									<PaddingBottom>10pt</PaddingBottom>
								</Style>
							</Textbox>

							<!-- Matrix for each page group -->
							<Matrix Name="matrixStudentAssessments">
								<CornerCell />
								<MatrixColumns>
									<MatrixColumn>
										<Width>2.5cm</Width>
									</MatrixColumn>
								</MatrixColumns>
								<MatrixRows>
									<MatrixRow>
										<Height>0.6cm</Height>
										<MatrixCells>
											<MatrixCell>
												<ReportItems>
													<Textbox Name="cellValue">
														<Paragraphs>
															<Paragraph>
																<TextRuns>
																	<TextRun>
																		<Value>
																			=IIF(Fields!IsTotal.Value,
																			Fields!TotalMarks.Value,
																			Fields!Marks.Value)
																		</Value>
																		<Style>
																			<Color>=IIF(Fields!IsTotal.Value AND Fields!TotalMarks.Value &lt; 20, "Red", "Black")</Color>
																			<FontWeight>=IIF(Fields!IsTotal.Value AND Fields!TotalMarks.Value &lt; 20, "Bold", "Normal")</FontWeight>
																		</Style>
																	</TextRun>
																</TextRuns>
																<Style>
																	<TextAlign>Center</TextAlign>
																</Style>
															</Paragraph>
														</Paragraphs>
														<Style>
															<Border>
																<Color>LightGrey</Color>
																<Style>Solid</Style>
															</Border>
															<PaddingTop>2pt</PaddingTop>
															<PaddingBottom>2pt</PaddingBottom>
														</Style>
													</Textbox>
												</ReportItems>
											</MatrixCell>
										</MatrixCells>
									</MatrixRow>
								</MatrixRows>

								<!-- Column Groups (Course/Assessment combinations) -->
								<MatrixColumnGroups>
									<MatrixColumnGroup>
										<Width>2.5cm</Width>
										<Grouping>
											<GroupExpressions>
												<GroupExpression>=Fields!Course_Code.Value &amp; "_" &amp; Fields!Assessment_Name.Value</GroupExpression>
											</GroupExpressions>
										</Grouping>
										<SortExpressions>
											<SortExpression>
												<Value>=Fields!CourseOrder.Value</Value>
											</SortExpression>
											<SortExpression>
												<Value>=IIF(Fields!Assessment_Name.Value="Total", 9999, Fields!Assessment_ID.Value)</Value>
											</SortExpression>
										</SortExpressions>
										<Header>
											<Size>0.7cm</Size>
											<CellContents>
												<Textbox Name="colHeader">
													<Paragraphs>
														<Paragraph>
															<TextRuns>
																<TextRun>
																	<Value>=Fields!Course_Code.Value &amp; "/" &amp; Fields!Assessment_Name.Value</Value>
																	<Style>
																		<FontWeight>Bold</FontWeight>
																		<FontSize>9pt</FontSize>
																	</Style>
																</TextRun>
															</TextRuns>
															<Style>
																<TextAlign>Center</TextAlign>
															</Style>
														</Paragraph>
													</Paragraphs>
													<Style>
														<BackgroundColor>LightSteelBlue</BackgroundColor>
														<Border>
															<Color>LightGrey</Color>
															<Style>Solid</Style>
														</Border>
														<PaddingTop>2pt</PaddingTop>
														<PaddingBottom>2pt</PaddingBottom>
													</Style>
												</Textbox>
											</CellContents>
										</Header>
									</MatrixColumnGroup>
								</MatrixColumnGroups>

								<!-- Row Groups (Students) -->
								<MatrixRowGroups>
									<MatrixRowGroup>
										<Width>9.5cm</Width>
										<Grouping>
											<GroupExpressions>
												<GroupExpression>=Fields!Register_Number.Value</GroupExpression>
											</GroupExpressions>
										</Grouping>
										<SortExpressions>
											<SortExpression>
												<Value>=Fields!Register_Number.Value</Value>
											</SortExpression>
										</SortExpressions>
										<Header>
											<Size>9.5cm</Size>
											<CellContents>
												<Rectangle Name="rectStudentInfo">
													<ReportItems>
														<!-- Register Number -->
														<Textbox Name="txtRegNum">
															<Paragraphs>
																<Paragraph>
																	<TextRuns>
																		<TextRun>
																			<Value>=Fields!Register_Number.Value</Value>
																			<Style>
																				<FontWeight>Bold</FontWeight>
																			</Style>
																		</TextRun>
																	</TextRuns>
																</Paragraph>
															</Paragraphs>
															<Top>0cm</Top>
															<Left>0cm</Left>
															<Height>0.6cm</Height>
															<Width>3cm</Width>
															<Style>
																<Border>
																	<Color>LightGrey</Color>
																	<Style>Solid</Style>
																</Border>
																<BackgroundColor>LightYellow</BackgroundColor>
																<PaddingLeft>3pt</PaddingLeft>
																<PaddingTop>2pt</PaddingTop>
																<VerticalAlign>Middle</VerticalAlign>
															</Style>
														</Textbox>
														<!-- Student Name -->
														<Textbox Name="txtStudentName">
															<Paragraphs>
																<Paragraph>
																	<TextRuns>
																		<TextRun>
																			<Value>=Fields!Name.Value</Value>
																		</TextRun>
																	</TextRuns>
																</Paragraph>
															</Paragraphs>
															<Top>0cm</Top>
															<Left>3cm</Left>
															<Height>0.6cm</Height>
															<Width>5cm</Width>
															<Style>
																<Border>
																	<Color>LightGrey</Color>
																	<Style>Solid</Style>
																</Border>
																<BackgroundColor>LightYellow</BackgroundColor>
																<PaddingLeft>3pt</PaddingLeft>
																<PaddingTop>2pt</PaddingTop>
																<VerticalAlign>Middle</VerticalAlign>
															</Style>
														</Textbox>
														<!-- Semester -->
														<Textbox Name="txtSem">
															<Paragraphs>
																<Paragraph>
																	<TextRuns>
																		<TextRun>
																			<Value>=Fields!Sem.Value</Value>
																		</TextRun>
																	</TextRuns>
																	<Style>
																		<TextAlign>Center</TextAlign>
																	</Style>
																</Paragraph>
															</Paragraphs>
															<Top>0cm</Top>
															<Left>8cm</Left>
															<Height>0.6cm</Height>
															<Width>1.5cm</Width>
															<Style>
																<Border>
																	<Color>LightGrey</Color>
																	<Style>Solid</Style>
																</Border>
																<BackgroundColor>LightYellow</BackgroundColor>
																<PaddingTop>2pt</PaddingTop>
																<VerticalAlign>Middle</VerticalAlign>
															</Style>
														</Textbox>
													</ReportItems>
													<Style />
												</Rectangle>
											</CellContents>
										</Header>
									</MatrixRowGroup>
								</MatrixRowGroups>

								<DataSetName>IADataSource</DataSetName>
								<Filters>
									<Filter>
										<FilterExpression>=Ceiling(Fields!CourseOrder.Value / 2.0)</FilterExpression>
										<Operator>Equal</Operator>
										<FilterValues>
											<FilterValue>=Ceiling(First(Fields!CourseOrder.Value, "lstPageGroups") / 2.0)</FilterValue>
										</FilterValues>
									</Filter>
								</Filters>
								<Top>1cm</Top>
								<Left>0.5cm</Left>
								<Height>2cm</Height>
								<Width>18cm</Width>
								<Style>
									<Border>
										<Style>None</Style>
									</Border>
								</Style>
							</Matrix>
						</ReportItems>
						<Top>0.5cm</Top>
						<Left>0cm</Left>
						<Height>4cm</Height>
						<Width>19cm</Width>
						<PageBreak>
							<BreakLocation>Between</BreakLocation>
						</PageBreak>
						<Style />
					</List>
				</ReportItems>
				<Height>6in</Height>
				<Style />
			</Body>
			<Width>21cm</Width>
			<Page>
				<PageHeight>29.7cm</PageHeight>
				<PageWidth>21cm</PageWidth>
				<LeftMargin>1cm</LeftMargin>
				<RightMargin>1cm</RightMargin>
				<TopMargin>1cm</TopMargin>
				<BottomMargin>1cm</BottomMargin>
				<Style />
			</Page>
		</ReportSection>
	</ReportSections>

	<rd:ReportUnitType>Cm</rd:ReportUnitType>
	<rd:ReportID>ab2f0b0c-2c2e-42d0-99af-1a1dc6b7b777</rd:ReportID>
</Report>